{
  "openapi": "3.0.0",
  "info": {
    "title": "Warehouse Management API",
    "version": "1.0.0",
    "description": "API cho hệ thống quản lý kho"
  },
  "servers": [
    {
      "url": "http://localhost:4000",
      "description": "Local server"
    }
  ],
  "paths": {
    "/api/v1/auth/register": {
      "post": {
        "summary": "Đăng ký tài khoản",
        "tags": ["Auth"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": { "type": "string", "example": "user@example.com" },
                  "username": { "type": "string", "example": "phatnguyen" },
                  "password": { "type": "string", "example": "123456" }
                },
                "required": ["email", "username", "password"]
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Đăng ký thành công" },
          "400": { "description": "Email đã được sử dụng" },
          "500": { "description": "Lỗi server" }
        }
      }
    },
    "/api/v1/auth/login": {
      "post": {
        "summary": "Đăng nhập hệ thống",
        "tags": ["Auth"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": { "type": "string", "example": "user@example.com" },
                  "password": { "type": "string", "example": "123456" }
                },
                "required": ["email", "password"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Đăng nhập thành công (trả về accessToken và refreshToken)"
          },
          "400": { "description": "Sai mật khẩu" },
          "404": { "description": "Email không tồn tại" },
          "500": { "description": "Lỗi server" }
        }
      }
    },
    "/api/v1/auth/refreshToken": {
      "post": {
        "summary": "Làm mới access token",
        "tags": ["Auth"],
        "description": "Dùng refreshToken để lấy accessToken mới. \n- Web: refreshToken thường lưu trong cookie (httpOnly). \n- Mobile app: refreshToken có thể được gửi trong body.",
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "refreshToken": {
                    "type": "string",
                    "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Trả về accessToken mới",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "accessToken": {
                      "type": "string",
                      "example": "newAccessToken123456"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Không có refresh token (chưa đăng nhập)"
          },
          "403": {
            "description": "Refresh token không hợp lệ hoặc đã hết hạn"
          },
          "500": {
            "description": "Lỗi server"
          }
        }
      }
    },
    "/api/v1/auth/verify-otp": {
      "post": {
        "summary": "Xác thực mã OTP",
        "tags": ["Auth"],
        "description": "Xác thực mã OTP 6 chữ số để verify email sau khi đăng ký",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "example": "user@example.com",
                    "description": "Email đã đăng ký"
                  },
                  "otp": {
                    "type": "string",
                    "example": "123456",
                    "description": "Mã OTP 6 chữ số"
                  }
                },
                "required": ["email", "otp"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Xác thực OTP thành công",
            "content": {
              "application/json": {
                "example": {
                  "success": true,
                  "message": "Email verified successfully"
                }
              }
            }
          },
          "400": {
            "description": "OTP không hợp lệ, đã hết hạn hoặc email đã được verify",
            "content": {
              "application/json": {
                "examples": {
                  "invalid_otp": {
                    "summary": "OTP không đúng",
                    "value": {
                      "success": false,
                      "message": "Invalid OTP code"
                    }
                  },
                  "expired_otp": {
                    "summary": "OTP đã hết hạn",
                    "value": {
                      "success": false,
                      "message": "OTP has expired. Please request a new one."
                    }
                  },
                  "already_verified": {
                    "summary": "Email đã được verify",
                    "value": {
                      "success": false,
                      "message": "Email already verified"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Không tìm thấy user",
            "content": {
              "application/json": {
                "example": {
                  "success": false,
                  "message": "User not found"
                }
              }
            }
          },
          "500": {
            "description": "Lỗi server"
          }
        }
      }
    },
    "/api/v1/auth/resend-otp": {
      "post": {
        "summary": "Gửi lại mã OTP",
        "tags": ["Auth"],
        "description": "Gửi lại mã OTP mới khi mã cũ hết hạn hoặc không nhận được",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "example": "user@example.com",
                    "description": "Email đã đăng ký nhưng chưa verify"
                  }
                },
                "required": ["email"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Gửi lại OTP thành công",
            "content": {
              "application/json": {
                "example": {
                  "success": true,
                  "message": "OTP sent successfully. Please check your email."
                }
              }
            }
          },
          "400": {
            "description": "Email đã được verify hoặc không hợp lệ",
            "content": {
              "application/json": {
                "example": {
                  "success": false,
                  "message": "Email already verified"
                }
              }
            }
          },
          "404": {
            "description": "Không tìm thấy user",
            "content": {
              "application/json": {
                "example": {
                  "success": false,
                  "message": "User not found"
                }
              }
            }
          },
          "500": {
            "description": "Lỗi server"
          }
        }
      }
    },
    "/api/v1/auth/logout": {
      "post": {
        "summary": "Đăng xuất",
        "tags": ["Auth"],
        "description": "Xoá refresh token phía client",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Đăng xuất thành công"
          },
          "500": {
            "description": "Lỗi server"
          }
        }
      }
    },
    "/api/v1/user/info": {
      "get": {
        "summary": "Lấy thông tin người dùng",
        "tags": ["User"],
        "description": "Yêu cầu accessToken hợp lệ trong header Authorization (Bearer Token).",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Lấy thông tin user thành công",
            "content": {
              "application/json": {
                "example": {
                  "success": true,
                  "message": "Get info success",
                  "data": {
                    "_id": "64a1b23c45f6789012345678",
                    "username": "example_user",
                    "surName": "Example Surname",
                    "birthday": "2000-01-01",
                    "company": "Example Company"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Không tìm thấy user"
          },
          "500": {
            "description": "Lỗi server"
          }
        }
      }
    },
    "/api/v1/user/change": {
      "put": {
        "summary": "Cập nhật thông tin người dùng",
        "tags": ["User"],
        "description": "Yêu cầu accessToken hợp lệ trong header Authorization (Bearer Token).",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "username": { "type": "string" },
                  "surName": { "type": "string" },
                  "birthday": { "type": "string", "format": "date" },
                  "company": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Cập nhật user thành công",
            "content": {
              "application/json": {
                "example": {
                  "success": true,
                  "message": "User info updated successfully",
                  "data": {
                    "_id": "64a1b23c45f6789012345678",
                    "username": "new_username",
                    "surName": "New Surname",
                    "birthday": "2000-01-01",
                    "company": "New Company"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Không tìm thấy user"
          },
          "500": {
            "description": "Lỗi server"
          }
        }
      }
    },
    "/api/v1/products/all": {
      "get": {
        "summary": "Lấy tất cả sản phẩm",
        "tags": ["Product"],
        "description": "Yêu cầu accessToken hợp lệ trong header Authorization (Bearer Token).",
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Danh sách sản phẩm",
            "content": {
              "application/json": {
                "example": {
                  "success": true,
                  "message": "Get products success",
                  "data": [
                    {
                      "productName": "Laptop Dell XPS 13",
                      "cost": "800",
                      "price": "1000",
                      "SKU": "DELLXPS13-001",
                      "barcode": "1234567890001",
                      "category": "Ultrabook",
                      "RAM": "16GB",
                      "date": "2023-09-01",
                      "GPU": "Intel Iris Xe",
                      "color": "Silver",
                      "processor": "Intel Core i7-1165G7",
                      "quantity": 78,
                      "image": "https://res.cloudinary.com/djmeybzjk/image/upload/v1756458845/1_luwerf.png"
                    },
                    {
                      "productName": "Laptop MacBook Air M2",
                      "cost": "900",
                      "price": "1200",
                      "SKU": "MBAIR-M2-002",
                      "barcode": "1234567890002",
                      "category": "Ultrabook",
                      "RAM": "8GB",
                      "date": "2023-10-15",
                      "GPU": "Apple M2 GPU",
                      "color": "Space Gray",
                      "processor": "Apple M2",
                      "quantity": 95,
                      "image": "https://res.cloudinary.com/djmeybzjk/image/upload/v1756458843/11_uek4xh.png"
                    }
                  ]
                }
              }
            }
          },
          "404": { "description": "Không có sản phẩm nào" },
          "500": { "description": "Lỗi server" }
        }
      }
    },
    "/api/v1/products/single/{productId}": {
      "get": {
        "summary": "Lấy thông tin chi tiết sản phẩm",
        "tags": ["Product"],
        "description": "Yêu cầu accessToken hợp lệ trong header Authorization (Bearer Token).",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "productId",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "ID của sản phẩm"
          }
        ],
        "responses": {
          "200": {
            "description": "Thông tin sản phẩm",
            "content": {
              "application/json": {
                "example": {
                  "productName": "Laptop Dell XPS 13",
                  "cost": "800",
                  "price": "1000",
                  "SKU": "DELLXPS13-001",
                  "barcode": "1234567890001",
                  "category": "Ultrabook",
                  "RAM": "16GB",
                  "date": "2023-09-01",
                  "GPU": "Intel Iris Xe",
                  "color": "Silver",
                  "processor": "Intel Core i7-1165G7",
                  "quantity": 78,
                  "image": "https://res.cloudinary.com/djmeybzjk/image/upload/v1756458845/1_luwerf.png"
                }
              }
            }
          },
          "404": { "description": "Không tìm thấy sản phẩm" },
          "500": { "description": "Lỗi server" }
        }
      }
    },
    "/api/v1/products/create": {
      "post": {
        "summary": "Tạo sản phẩm mới",
        "tags": ["Product"],
        "description": "Yêu cầu accessToken hợp lệ trong header Authorization (Bearer Token). Sản phẩm có thể kèm ảnh (upload qua Cloudinary).",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "image": {
                    "type": "string",
                    "format": "binary",
                    "description": "Ảnh sản phẩm (upload file)"
                  },
                  "productName": {
                    "type": "string",
                    "example": "Laptop Dell XPS 13"
                  },
                  "SKU": { "type": "string", "example": "DELLXPS13-001" },
                  "barcode": { "type": "string", "example": "1234567890001" },
                  "category": { "type": "string", "example": "Ultrabook" },
                  "quantity": { "type": "integer", "example": 50 },
                  "cost": { "type": "number", "example": 800 },
                  "price": { "type": "number", "example": 1000 },
                  "RAM": { "type": "string", "example": "16GB" },
                  "date": {
                    "type": "string",
                    "format": "date",
                    "example": "2023-09-01"
                  },
                  "GPU": { "type": "string", "example": "Intel Iris Xe" },
                  "color": { "type": "string", "example": "Silver" },
                  "processor": {
                    "type": "string",
                    "example": "Intel Core i7-1165G7"
                  }
                },
                "required": ["productName", "SKU", "price", "quantity"]
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Tạo sản phẩm thành công",
            "content": {
              "application/json": {
                "example": {
                  "success": true,
                  "message": "Product created successfully",
                  "product": {
                    "_id": "64a1b23c45f6789012345678",
                    "image": "https://res.cloudinary.com/demo/image/upload/v1234567890/product.jpg",
                    "productName": "Laptop Dell XPS 13",
                    "SKU": "DELLXPS13-001",
                    "barcode": "1234567890001",
                    "category": "Ultrabook",
                    "quantity": 50,
                    "cost": 800,
                    "price": 1000,
                    "RAM": "16GB",
                    "date": "2023-09-01",
                    "GPU": "Intel Iris Xe",
                    "color": "Silver",
                    "processor": "Intel Core i7-1165G7",
                    "createdBy": "64a1a11145f6789012345666"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Sản phẩm trùng SKU"
          },
          "401": {
            "description": "Không có hoặc sai accessToken"
          },
          "404": {
            "description": "Không tìm thấy user"
          },
          "500": {
            "description": "Lỗi server"
          }
        }
      }
    }
  },  
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  }
}
